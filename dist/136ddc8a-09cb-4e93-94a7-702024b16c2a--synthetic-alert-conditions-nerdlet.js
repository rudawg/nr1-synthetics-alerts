var __NR_MODULES="object"==typeof __NR_MODULES?__NR_MODULES:{};__NR_MODULES["136ddc8a-09cb-4e93-94a7-702024b16c2a--synthetic-alert-conditions-nerdlet"]=function(e){function t(t){for(var r,a,s=t[0],c=t[1],l=t[2],d=0,p=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(u&&u(t);p.length;)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={0:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a.p=window.__NR_PUBLIC_PATH||a.p;var s=window["webpackJsonp__136ddc8a-09cb-4e93-94a7-702024b16c2a"]=window["webpackJsonp__136ddc8a-09cb-4e93-94a7-702024b16c2a"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;return i.push([22,1]),n()}({0:function(e,t){e.exports=__NR1_EXTERNAL_LIB__},1:function(e,t){e.exports=React},22:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return x}));var r=n(7),o=n.n(r),i=n(8),a=n.n(i),s=n(9),c=n.n(s),l=n(10),u=n.n(l),d=n(5),p=n.n(d),h=n(1),f=n.n(h),m=n(12),y=n.n(m),g=n(2),I=n.n(g),C=n(3),v=n.n(C),E=n(4),b=n.n(E),T=n(14),N=n.n(T),w=n(6),S=function(e){var t=e.bgcolor,n=e.completed,r={height:"100%",width:"".concat(n,"%"),backgroundColor:t,borderRadius:"inherit",textAlign:"right"};return React.createElement("div",{style:{height:20,width:"100%",backgroundColor:"#e0e0de",borderRadius:50,margin:50}},React.createElement("div",{style:r},React.createElement("span",{style:{padding:5,color:"white",fontWeight:"bold"}},"".concat(n,"%"))))},_=n(0);function R(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}w.config({cancellation:!0});var P=function(e){c()(E,e);var t,n,r,i,s,l,d,h,m,y,g,C=(t=E,function(){var e,n=p()(t);if(A()){var r=p()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return u()(this,e)});function E(e){var t;return o()(this,E),(t=C.call(this,e)).state={accountId:null,personalKey:null,adminKey:null,conditionsLoaded:!1,apiKeyUrl:null,guid:null,monitorId:null,allConditions:[],finalConditions:[],filteredConditions:[],policyIds:[],completed:0,loading:!1,loadingConditions:!1,showApi:!1,nerdletGuid:null,noConditions:!1,noId:!1},t.handleAdminKeyChange=t.handleAdminKeyChange.bind(b()(t)),t.getPolicies=t.getPolicies.bind(b()(t)),t.getSynthConditions=t.getSynthConditions.bind(b()(t)),t.getPromises=t.getPromises.bind(b()(t)),t.getMonitorId=t.getMonitorId.bind(b()(t)),t.filterConditions=t.filterConditions.bind(b()(t)),t.getNrqlName=t.getNrqlName.bind(b()(t)),t.getNrqlId=t.getNrqlId.bind(b()(t)),t.getNrqlFacetName=t.getNrqlFacetName.bind(b()(t)),t.getNrqlFacetId=t.getNrqlFacetId.bind(b()(t)),t.getConditionsTest=t.getConditionsTest.bind(b()(t)),t}return a()(E,[{key:"getConditionsTest",value:(g=v()(I.a.mark((function e(t,n){var r,o;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.accountId,r="https://api.newrelic.com/v2/alerts_synthetics_conditions.json?policy_id="+n.id,e.next=4,fetch(r,{method:"GET",headers:{"X-Api-Key":t,"Content-Type":"application/json"}}).then((function(e){var t;return e.ok?t=200:401===e.status?t=401:401===e.status?t=404:500===e.status&&(t=500),t}));case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return g.apply(this,arguments)})},{key:"getSynthConditions",value:function(e,t){var n=this.state.accountId,r=this;return new w((function(o,i){var a="https://api.newrelic.com/v2/alerts_synthetics_conditions.json?policy_id="+t.id;fetch(a,{method:"GET",headers:{"X-Api-Key":e,"Content-Type":"application/json"}}).then((function(e){if(401===e.status)throw new Error("Invalid API Key");return e.json()})).then((function(e){if(e.synthetics_conditions.length>0){var i,a=r.state.allConditions,s=R(e.synthetics_conditions);try{for(s.s();!(i=s.n()).done;){var c=i.value;c.policy=t,c.type="Single",c.entities=[],c.entities.push(c.monitor_id);var l=btoa('{"nerdletId":"alerting-ui-classic.policies","nav":"Policies","selectedField":"thresholds","policyId":"'+c.policy.id+'","conditionId":"'+c.id+'"}');c.permalink="https://one.newrelic.com/launcher/nrai.launcher?pane="+l+"&sidebars[0]=eyJuZXJkbGV0SWQiOiJucmFpLm5hdmlnYXRpb24tYmFyIiwibmF2IjoiUG9saWNpZXMifQ&platform[accountId]="+n,a.push(c)}}catch(e){s.e(e)}finally{s.f()}r.setState({allConditions:a,filteredConditions:a})}o()})).catch((function(e){console.log(e),i()}))}))}},{key:"getMultiConditions",value:function(e,t){var n=this.state.accountId,r=this;return new w((function(o,i){var a="https://api.newrelic.com/v2/alerts_location_failure_conditions/policies/"+t.id+".json";fetch(a,{method:"GET",headers:{"X-Api-Key":e,"Content-Type":"application/json"}}).then((function(e){if(console.log("Response",e.status),401===e.status)throw new Error("Invalid API Key");if(500===e.status)throw new Error("Internal Server Error");if(404===e.status)throw r.setState({noConditions:!0}),new Error("No Conditions Targetting this monitor");return e.json()})).then((function(e){if(e.location_failure_conditions.length>0){var i,a=r.state.allConditions,s=R(e.location_failure_conditions);try{for(s.s();!(i=s.n()).done;){var c=i.value;c.policy=t,c.type="Multi";var l=btoa('{"nerdletId":"alerting-ui-classic.policies","nav":"Policies","selectedField":"thresholds","policyId":"'+c.policy.id+'","conditionId":"'+c.id+'"}');c.permalink="https://one.newrelic.com/launcher/nrai.launcher?pane="+l+"&sidebars[0]=eyJuZXJkbGV0SWQiOiJucmFpLm5hdmlnYXRpb24tYmFyIiwibmF2IjoiUG9saWNpZXMifQ&platform[accountId]="+n,a.push(c)}}catch(e){s.e(e)}finally{s.f()}}r.setState({completed:r.state.completed+1}),o()})).catch((function(e){console.log(e),i()}))}))}},{key:"getPromises",value:(y=v()(I.a.mark((function e(t,n){var r,o,i,a,s,c,l,u;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],o=this,i=n[0],console.log("Testing Admin Key"),e.next=5,o.getConditionsTest(t,i);case 5:if(a=e.sent,console.log("Test results",a),401!=a){e.next=12;break}return console.log("Unauthorized"),e.abrupt("return",401);case 12:if(200!=a){e.next=21;break}console.log(""),s=R(n);try{for(s.s();!(c=s.n()).done;)l=c.value,r.push(o.getSynthConditions(t,l)),r.push(o.getMultiConditions(t,l))}catch(e){s.e(e)}finally{s.f()}return e.next=18,w.all(r).then((function(e){return console.log("All Promises complete",e),_.Toast.showToast({title:"Success",description:"Loaded "+o.state.allConditions.length+" Conditions",type:_.Toast.TYPE.NORMAL}),e})).catch((function(e){console.log("Promises",e),o.setState({loading:!1}),_.Toast.showToast({title:"Error",description:e,type:_.Toast.TYPE.CRITICAL}),r.forEach((function(e){return e.cancel()}))}));case 18:return u=e.sent,console.log("After get Promises"),e.abrupt("return",u);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"handleAdminKeyChange",value:function(e){if(e.length>0){var t=this,n=t.state.policyIds;function r(){return(r=v()(I.a.mark((function r(){var o;return I.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("Getting Promises"),r.next=3,t.getPromises(e,n);case 3:if(401!==r.sent){r.next=8;break}return r.abrupt("return",401);case 8:return console.log("Getting NRQLs"),r.next=11,t.getNrqls();case 11:return r.sent,r.next=14,t.filterConditions();case 14:return o=r.sent,console.log("Filtered Chain",o),r.abrupt("return",200);case 17:case"end":return r.stop()}}),r)})))).apply(this,arguments)}t.setState({adminKey:e,loadingConditions:!0}),function(){return r.apply(this,arguments)}().then((function(e){200===e?t.setState({loadingConditions:!1,conditionsLoaded:!0}):401===e&&(_.Toast.showToast({title:"Error",description:"API Key is Unauthorized, please check",type:_.Toast.TYPE.CRITICAL}),t.setState({loadingConditions:!1}))})).catch((function(e){t.setState({loadingConditions:!1}),_.Toast.showToast({title:"Error",description:e,type:_.Toast.TYPE.CRITICAL})}))}else _.Toast.showToast({title:"Error",description:"Admin Key is Empty",type:_.Toast.TYPE.CRITICAL})}},{key:"getNrqlName",value:(m=v()(I.a.mark((function e(t){var n,r,o,i;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=this).state.accountId,o="\n        {\n            actor {\n            account(id: "+r+") {\n                alerts {\n                \n                nrqlConditionsSearch(searchCriteria: {queryLike: \"'"+t+"'\"}) {\n                    nextCursor\n                    nrqlConditions {\n                    enabled\n                    id\n                    name\n                    nrql {\n                        query\n                    }\n                    policyId\n                    }\n                }\n                \n                }\n            }\n            }\n        }\n        ",e.next=5,_.NerdGraphQuery.query({query:o}).then((function(e){if(e.data.errors)throw new Error(e.data.errors);var o=e.data.actor.account.alerts.nrqlConditionsSearch.nrqlConditions;if(o[0]){var i,a=n.state.filteredConditions,s=R(o);try{for(s.s();!(i=s.n()).done;){var c=i.value;c.type="NRQL",c.entities=[];var l=btoa('{"nerdletId":"alerting-ui-classic.policies","nav":"Policies","selectedField":"thresholds","policyId":"'+c.policyId+'","conditionId":"'+c.id+'"}');c.permalink="https://one.newrelic.com/launcher/nrai.launcher?pane="+l+"&sidebars[0]=eyJuZXJkbGV0SWQiOiJucmFpLm5hdmlnYXRpb24tYmFyIiwibmF2IjoiUG9saWNpZXMifQ&platform[accountId]="+r,a.push(c)}}catch(e){s.e(e)}finally{s.f()}return n.setState({filteredConditions:a}),a}return console.log("No NRQL Conditions targeting monitorName: "+t),null}));case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"getNrqlId",value:(h=v()(I.a.mark((function e(t,n,r){var o,i,a,s;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(o=this).state.accountId,a="\n        {\n            actor {\n            account(id: "+i+") {\n                alerts {\n                \n                nrqlConditionsSearch(searchCriteria: {queryLike: \"'"+t+"'\"}) {\n                    nextCursor\n                    nrqlConditions {\n                    enabled\n                    id\n                    name\n                    nrql {\n                        query\n                    }\n                    policyId\n                    }\n                }\n                \n                }\n            }\n            }\n        }\n        ",e.next=5,_.NerdGraphQuery.query({query:a}).then((function(e){e.data.errors&&r(e.data.errors);var n=e.data.actor.account.alerts.nrqlConditionsSearch.nrqlConditions;if(n[0]){var a,s=o.state.filteredConditions,c=R(n);try{for(c.s();!(a=c.n()).done;){var l=a.value;l.type="NRQL",l.entities=[];var u=btoa('{"nerdletId":"alerting-ui-classic.policies","nav":"Policies","selectedField":"thresholds","policyId":"'+l.policyId+'","conditionId":"'+l.id+'"}');l.permalink="https://one.newrelic.com/launcher/nrai.launcher?pane="+u+"&sidebars[0]=eyJuZXJkbGV0SWQiOiJucmFpLm5hdmlnYXRpb24tYmFyIiwibmF2IjoiUG9saWNpZXMifQ&platform[accountId]="+i,s.push(l)}}catch(e){c.e(e)}finally{c.f()}return o.setState({filteredConditions:s}),s}return console.log("No NRQL Conditions targeting monitorId: "+t),null}));case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return h.apply(this,arguments)})},{key:"getNrqlFacetName",value:(d=v()(I.a.mark((function e(){var t,n,r,o;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=this).state.accountId,r="\n        {\n            actor {\n            account(id: "+n+') {\n                alerts {\n                \n                nrqlConditionsSearch(searchCriteria: {queryLike: "FACET monitorName"}) {\n                    nextCursor\n                    nrqlConditions {\n                    enabled\n                    id\n                    name\n                    nrql {\n                        query\n                    }\n                    policyId\n                    }\n                }\n                \n                }\n            }\n            }\n        }\n        ',e.next=5,_.NerdGraphQuery.query({query:r}).then((function(e){if(e.data.errors)throw new Error(e.data.errors);var r=e.data.actor.account.alerts.nrqlConditionsSearch.nrqlConditions;if(r[0]){var o,i=t.state.filteredConditions,a=R(r);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.type="NRQL Facet",s.facet=!0,s.entities=[];var c=btoa('{"nerdletId":"alerting-ui-classic.policies","nav":"Policies","selectedField":"thresholds","policyId":"'+s.policyId+'","conditionId":"'+s.id+'"}');s.permalink="https://one.newrelic.com/launcher/nrai.launcher?pane="+c+"&sidebars[0]=eyJuZXJkbGV0SWQiOiJucmFpLm5hdmlnYXRpb24tYmFyIiwibmF2IjoiUG9saWNpZXMifQ&platform[accountId]="+n,i.push(s)}}catch(e){a.e(e)}finally{a.f()}return t.setState({filteredConditions:i}),i}return console.log("No NRQL Conditions like `FACET monitorName`"),null}));case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"getNrqlFacetId",value:(l=v()(I.a.mark((function e(){var t,n,r,o;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=this).state.accountId,r="\n        {\n            actor {\n            account(id: "+n+') {\n                alerts {\n                \n                nrqlConditionsSearch(searchCriteria: {queryLike: "FACET monitorId"}) {\n                    nextCursor\n                    nrqlConditions {\n                    enabled\n                    id\n                    name\n                    nrql {\n                        query\n                    }\n                    policyId\n                    }\n                }\n                \n                }\n            }\n            }\n        }\n        ',e.next=5,_.NerdGraphQuery.query({query:r}).then((function(e){if(e.data.errors)throw new Error(e.data.errors);var r=e.data.actor.account.alerts.nrqlConditionsSearch.nrqlConditions;if(r[0]){var o,i=t.state.filteredConditions,a=R(r);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.type="NRQL Facet",s.entities=[];var c=btoa('{"nerdletId":"alerting-ui-classic.policies","nav":"Policies","selectedField":"thresholds","policyId":"'+s.policyId+'","conditionId":"'+s.id+'"}');s.permalink="https://one.newrelic.com/launcher/nrai.launcher?pane="+c+"&sidebars[0]=eyJuZXJkbGV0SWQiOiJucmFpLm5hdmlnYXRpb24tYmFyIiwibmF2IjoiUG9saWNpZXMifQ&platform[accountId]="+n,i.push(s)}}catch(e){a.e(e)}finally{a.f()}return t.setState({filteredConditions:i}),i}return console.log("No NRQL Conditions like `FACET monitorId`"),null}));case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"getNrqls",value:function(){var e=this,t=e.state.monitorId,n=e.state.monitorName;function r(){return(r=v()(I.a.mark((function r(){var o,i;return I.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("Getting Name Query"),r.next=3,e.getNrqlName(n);case 3:return o=r.sent,console.log("Getting ID Query",o),r.next=7,e.getNrqlId(t);case 7:return r.sent,console.log("Getting Facet Name Query"),r.next=11,e.getNrqlFacetName();case 11:return r.sent,console.log("Getting Facet Name Query"),r.next=15,e.getNrqlFacetId();case 15:return i=r.sent,r.abrupt("return",i);case 17:case"end":return r.stop()}}),r)})))).apply(this,arguments)}(function(){return r.apply(this,arguments)})().then((function(e){console.log("NRQLs Got",e)})).catch((function(t){e.setState({loading:!1}),_.Toast.showToast({title:"Error",description:t,type:_.Toast.TYPE.CRITICAL})}))}},{key:"filterConditions",value:(s=v()(I.a.mark((function e(t,n){var r,o;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.state.allConditions,o=this.state.monitorId,e.next=3,r.filter((function(e){return-1!==e.entities.indexOf(o)}));case 3:return r=e.sent,this.setState({filteredConditions:r}),e.abrupt("return");case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"getPolicies",value:(i=v()(I.a.mark((function e(t){var n,r,o=this;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="\n            {\n                actor {\n                    account(id: "+t+") {\n                        alerts {\n                            policiesSearch {\n                                nextCursor\n                                policies {\n                                    id\n                                    name\n                                    incidentPreference\n                                }\n                                totalCount\n                            }\n                        }\n                    }\n                }\n            }\n        ",e.next=3,_.NerdGraphQuery.query({query:n}).then((function(e){e.data.errors&&reject(e.data.errors);var t=e.data.actor.account.alerts.policiesSearch.policies;return t?(o.setState({policyIds:t}),_.Toast.showToast({title:"Success",description:"Loaded "+t.length+" Policies",type:_.Toast.TYPE.NORMAL})):_.Toast.showToast({title:"Error",description:"No Policies found, try refreshing the page",type:_.Toast.TYPE.CRITICAL}),t}));case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"getMonitorName",value:(r=v()(I.a.mark((function e(t){var n,r,o=this;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n='\n            {\n                actor {\n                \n                entity(guid: "'+t+'") {\n                    ... on SyntheticMonitorEntity {\n                    guid\n                    name\n                    }\n                    account{\n                        id\n                    }\n                    entityType\n                    permalink\n                    reporting\n                    type\n                    domain\n                    name\n                }\n                }\n            }\n            ',e.next=3,_.NerdGraphQuery.query({query:n}).then((function(e){if(console.log("Getting Name",e),e.data.errors)throw new Error(e.data.errors);var t=e.data.actor.entity;if(console.log("NerdG MonitorName",t),t){var n="https://rpm.newrelic.com/accounts/"+t.account.id+"/integrations?page=api_keys";o.setState({accountId:t.account.id,apiKeyUrl:n}),console.log("Got MonitorName and Id",t.account.id)}else console.log("No Monitor Name Found");return t}));case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"getMonitorId",value:(n=v()(I.a.mark((function e(t,n){var r,o,i=this;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n            {\n                actor {\n                account(id: "+n+") {\n                    nrql(query: \"SELECT latest(monitorId) FROM SyntheticCheck WHERE monitorName = '"+t+"' SINCE 13 month ago\") {\n                    results\n                    }\n                }\n                }\n            }\n            ",e.next=3,_.NerdGraphQuery.query({query:r}).then((function(e){if(e.data.errors)throw new Error(e.data.errors);var t=e.data.actor.account.nrql.results[0]["latest.monitorId"];return console.log("NerdG MonitorId",t),t?i.setState({id:t}):i.setState({noId:!0}),t}));case 3:return o=e.sent,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"componentDidMount",value:function(){var e=this,t=e.props.nerdletState.entityGuid;function n(){return(n=v()(I.a.mark((function n(){var r,o,i;return I.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.setState({loading:!0}),console.log("Getting Name"),n.next=4,e.getMonitorName(t);case 4:return r=n.sent,console.log("Getting Policies",r),n.next=8,e.getPolicies(r.account.id);case 8:return o=n.sent,console.log("Getting ID",o),n.next=12,e.getMonitorId(r.name,r.account.id);case 12:return i=n.sent,r.id=i,n.abrupt("return",r);case 15:case"end":return n.stop()}}),n)})))).apply(this,arguments)}(function(){return n.apply(this,arguments)})().then((function(t){console.log("Built Monitor",t),e.setState({monitorId:t.id,monitorName:t.name,showApi:!0,loading:!1})})).catch((function(t){e.setState({loading:!1}),_.Toast.showToast({title:"Error",description:t,type:_.Toast.TYPE.CRITICAL})}))}},{key:"render",value:function(){var e=this;return f.a.createElement(f.a.Fragment,null,f.a.createElement(_.Grid,{spacingType:[_.Grid.SPACING_TYPE.LARGE]},this.state.showApi&&!this.state.noId?f.a.createElement(_.GridItem,{columnSpan:4},f.a.createElement(_.TextField,{label:"Admin API Key",placeholder:"Admin API...",onChange:function(t){return e.handleAdminKeyChange(t.target.value)}}),f.a.createElement(_.Link,{to:this.state.apiKeyUrl},"Find your API Key"),this.state.conditionsLoaded?f.a.createElement(_.Card,null,f.a.createElement(_.CardBody,null,f.a.createElement(_.Icon,{type:_.Icon.TYPE.INTERFACE__INFO__INFO}),"These NRQL Conditions are general conditions that contain ",f.a.createElement("code",null,"FACET monitorName")," or ",f.a.createElement("code",null,"FACET monitorId"))):null):null,this.state.noConditions?f.a.createElement("pre",null,"No Conditions targetting this monitor"):null,this.state.noId?f.a.createElement(_.GridItem,{columnSpan:8},f.a.createElement("pre",null,"No Monitor ID found! If this monitor has run within the last 13 months try refreshing the page")):null,this.state.conditionsLoaded&&this.state.filteredConditions.length<1?f.a.createElement(_.GridItem,{columnSpan:8},f.a.createElement("pre",null,"This monitor ",this.state.monitorName," has no Alert Conditions targeting it! Set them up now in Alerts & AI")):null,this.state.conditionsLoaded&&this.state.filteredConditions.length>0?f.a.createElement(_.GridItem,{columnSpan:8},f.a.createElement(_.Table,{items:this.state.filteredConditions},f.a.createElement(_.TableHeader,null,f.a.createElement(_.TableHeaderCell,{value:function(e){return e.item}},"Condition"),f.a.createElement(_.TableHeaderCell,{value:function(e){return e.item.entities.length}},"Entities"),f.a.createElement(_.TableHeaderCell,{value:function(e){return e.item.type}},"Type"),f.a.createElement(_.TableHeaderCell,{value:function(e){return e.item.enabled}},"Enabled")),(function(e){var t=e.item;return f.a.createElement(_.TableRow,null,f.a.createElement(_.TableRowCell,null,"NRQL Facet"==t.type?f.a.createElement(_.Icon,{type:_.Icon.TYPE.INTERFACE__INFO__INFO}):null," ",f.a.createElement(_.Link,{to:t.permalink},t.name," ")),f.a.createElement(_.TableRowCell,null,f.a.createElement(_.Tooltip,{text:t.entities.join("\n"),placementType:_.Tooltip.PLACEMENT_TYPE.BOTTOM},t.entities.length>0?t.entities.length:"-")),f.a.createElement(_.TableRowCell,null,t.type),f.a.createElement(_.TableRowCell,null,t.enabled?f.a.createElement(_.Icon,{type:_.Icon.TYPE.INTERFACE__SIGN__CHECKMARK}):f.a.createElement(_.Icon,{type:_.Icon.TYPE.INTERFACE__SIGN__TIMES})))}))):null),this.state.loading?f.a.createElement(f.a.Fragment,null,f.a.createElement(_.HeadingText,{type:_.HeadingText.TYPE.HEADING_1},"Loading"),f.a.createElement(_.Spinner,{type:_.Spinner.TYPE.DOT,spacingType:[_.Spinner.SPACING_TYPE.EXTRA_LARGE],inline:!0})):null,this.state.loadingConditions?f.a.createElement(f.a.Fragment,null,f.a.createElement(_.HeadingText,{type:_.HeadingText.TYPE.HEADING_1},"Loading Conditions"),f.a.createElement(_.Grid,{spacingType:[_.Grid.SPACING_TYPE.LARGE]},f.a.createElement(_.GridItem,{columnSpan:4},f.a.createElement(S,{bgcolor:"#ef6c00",completed:Math.ceil(this.state.completed/this.state.policyIds.length*100)})))):null)}}]),E}(f.a.Component);function k(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}N()(P,"propTypes",{nerdletState:y.a.object.isRequired});var x=function(e){c()(r,e);var t,n=(t=r,function(){var e,n=p()(t);if(k()){var r=p()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return u()(this,e)});function r(){return o()(this,r),n.apply(this,arguments)}return a()(r,[{key:"render",value:function(){return f.a.createElement(_.PlatformStateContext.Consumer,null,(function(e){return f.a.createElement(_.NerdletStateContext.Consumer,null,(function(e){return f.a.createElement(P,{nerdletState:e})}))}))}}]),r}(f.a.Component)}});
//# sourceMappingURL=136ddc8a-09cb-4e93-94a7-702024b16c2a--synthetic-alert-conditions-nerdlet.js.map